# RPS

## Description 

Here's a program that plays rock, paper, scissors against you. I hear something good happens if you win 5 times in a row.

Connect to the program with netcat:

```bash
nc saturn.picoctf.net 51420
```

The program's source code with the flag redacted can be downloaded [here](https://artifacts.picoctf.net/c/442/game-redacted.c).


## Exploit

The exploit to this program can be explained by looking at this condition:

```c
char player_turn[100];
//..
int r = tgetinput(player_turn, 100);
//..
int computer_turn = rand() % 3;

//..
if (strstr(player_turn, loses[computer_turn])){
    //..
}
```

What `strstr` does is look for the first occurrence of the result of `loses[computer_turn]` inside `player_turn`.

`computer_turn` is a random number between 0 and 2.

But `player_turn` is our input.

So we can basically pass the following string into the program to ensure that there will always be a match in the condition:

```bash
Please make your selection (rock/paper/scissors):
rockpaperscissors
You played: rockpaperscissors
The computer played: scissors
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1


Please make your selection (rock/paper/scissors):
rockpaperscissors
You played: rockpaperscissors
The computer played: paper
You win! Play again?
Type '1' to play a game
Type '2' to exit the program
1

...
Please make your selection (rock/paper/scissors):
rockpaperscissors
You played: rockpaperscissors
The computer played: scissors
You win! Play again?
Congrats, here's the flag!
[REDACTED]
```